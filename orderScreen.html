<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/orderScreen.css" rel="stylesheet">
    <script src="js/logout.js"></script>
    <title>Your Order</title>
</head>

<body>
    <header class="black-header">
        <div class="containerNav">
            <div class="logo-container">
                <a class="navbar-brand" href="homeScreen.html"><img src="images/shop.webp" alt="TD Shop Logo"
                        class="logo"></a>
                <h1 class="company-name">TD Shop</h1>
            </div>
            <div class="search-container">
                <form class="search-form">
                    <input type="text" placeholder="Search">
                    <button class="myButton fancyButton" type="submit">Search</button>
                </form>
                <div class="profile-dropdown">
                    <button class="profile-button">User</button>
                    <div class="dropdown-content">
                        <a href="profileScreen.html">View Profile</a>
                        <a href="loginScreen.html" onclick="logout()">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <br>
    <div class="container">
        <div class="order" id="orderContainer">
            <h1 class="title">Your Order ID: </h1>
            <table id="orderTable">
                <thead>
                    <tr>
                        <th class="whiteText">Product</th>
                        <th class="whiteText">Price</th>
                        <th class="whiteText">Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Order items will be inserted here by JavaScript -->
                </tbody>
            </table>
        </div>
        <div class="orderSummary">
            <h1 class="purpleTitle">Order Summary</h1>
            <div class="orderSection" id="itemSubtotal">
                <!-- Item subtotal will be inserted here by JavaScript -->
            </div>
            <div class="orderSection" id="shipping">
                <!-- Shipping info will be inserted here by JavaScript -->
            </div>
            <div class="orderSection" id="orderTable">
                <!-- Order items will be inserted here by JavaScript -->
            </div>
            <div class="orderSection" id="total">
                <!-- Total will be inserted here by JavaScript -->
            </div>
            <div class="orderSeparator"></div>
            <button type="button" onclick="submitForm()">Put PayPal here</button>
        </div>
    </div>
    <!-- Include getOrder.js -->
    <script src="js/getOrder.js"></script>

    <script>
        window.onload = function () {
            getOrder(order => {
                // Display the order ID
                document.querySelector('.title').textContent += order.orderID;

                // Display the order items
                const orderTable = document.querySelector('#orderTable tbody');
                order.cart.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                <td>${item.name}</td>
                <td>${item.price}</td>
                <td>${item.qty}</td>
            `;
                    orderTable.appendChild(row);
                });

                // Display the shipping info
                document.querySelector('#shipping').textContent = `Shipping: ${order.shippingInfo.address}, ${order.shippingInfo.city}, ${order.shippingInfo.postalCode}, ${order.shippingInfo.country}`;

                // Display the total
                const total = order.cart.reduce((sum, item) => sum + item.price * item.qty, 0);
                document.querySelector('#total').textContent = `Total: ${total}`;
            });
        };
        // Add a click event listener to the logout button
        const logoutButton = document.getElementById('logout');
        if (logoutButton) {
            logoutButton.addEventListener('click', function () {
                // Clear the login status
                localStorage.setItem('isLoggedIn', false);
                clearCart();
                // Refresh the page
                location.reload();
            });
        }
    </script>
</body>

</html>