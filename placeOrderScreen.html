<!DOCTYPE html>
<html>

<head>
    <title>Place Order</title>
    <link href="css/placeOrderScreen.css" rel="stylesheet">
    <script src="products.js" type="module"></script>
    <script src="index.js" type="module"></script>
</head>

<body>
    <header class="black-header">
        <div class="container">
            <div class="logo-container">
                <a class="navbar-brand" href="homeScreen.html"><img src="images/shop.webp" alt="TD Shop Logo" class="logo"></a>
                <h1 class="company-name">TD Shop</h1>
            </div>
            <div class="search-container">
                <form class="search-form">
                    <input type="text" placeholder="Search">
                    <button class="myButton fancyButton" type="submit">Search</button>
                </form>
                <div class="profile-dropdown">
                    <button class="profile-button">User</button>
                    <div class="dropdown-content">
                        <a href="profileScreen.html">View Profile</a>
                        <a href="loginScreen.html">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <main>
        <br>
        <ul style="text-align:center;">
            <a class="whiteText" style="margin-right: 20px;" href="loginScreen.html">Login</a>
            <a class="whiteText" style="margin-right: 20px;" href="shippingScreen.html">Shipping</a>
            <a class="whiteText" style="margin-right: 20px;" href="paymentScreen.html">Payment</a>
            <a class="whiteText" style="margin-right: 20px;" href="placeOrderScreen.html">Place Order</a>
        </ul>
    </main>
    <footer class="p-footer-color">
        <p>Â©2023 TD-Shop</p>
    </footer>
    <script>
        // Fetch the cart and shipping information
        var cart = JSON.parse(localStorage.getItem('cart'));
        var shippingInfo = JSON.parse(localStorage.getItem('shippingInfo'));

        // Create the order object
        var order = {
            orderID: localStorage.getItem('orderID'),
            items: cart.items,
            shippingInfo: shippingInfo
        };

        // Get the shipping information section, order table, and order summary
        var shippingInfoSection = document.querySelector('.shipping-info');
        var orderTable = document.querySelector('.order table');
        var orderSummary = document.querySelector('.order-summary');

        // Initialize the item price
        var itemPrice = 0;

        // For each item in the order
        order.items.forEach(item => {
            // Create a table row
            var row = document.createElement('tr');
            row.innerHTML = `
    <td><img src="${item.image}" alt="${item.title}"></td>
    <td>${item.title}</td>
    <td>${item.price}</td>
  `;

            // Add the table row to the order table
            orderTable.appendChild(row);

            // Update the item price
            itemPrice += item.price * item.quantity;
        });

        // Calculate the shipping price, tax, and total price
        var shippingPrice = itemPrice < 50 ? itemPrice * 0.05 : 0;
        var tax = itemPrice * 0.1;
        var totalPrice = itemPrice + shippingPrice + tax;

        // Update the HTML of the shipping information section
        shippingInfoSection.innerHTML = `
  <p>Address: ${order.shippingInfo.address}</p>
  <p>City: ${order.shippingInfo.city}</p>
  <p>Postal Code: ${order.shippingInfo.postalCode}</p>
  <p>Country: ${order.shippingInfo.country}</p>
`;

        // Update the HTML of the order summary
        orderSummary.innerHTML = `
  <p>Item price: ${itemPrice}</p>
  <p>Shipping price: ${shippingPrice}</p>
  <p>Tax: ${tax}</p>
  <p>Total price: ${totalPrice}</p>
`;
    </script>
</body>

</html>